---
title: "Argentina"
output: 
  flexdashboard::flex_dashboard:
    theme: lumen
    source: embed
    logo: logoMBON_24px.png
    
---

```{r setup, include=FALSE, cache=TRUE}
library(flexdashboard)
library(ggplot2)
library(cowplot)
library(doBy)
library(reshape)
library(dplyr)
library(plotly)
library(ggpubr)

rm(list=ls()) ## clear variables


#Get data
#File names remain as downloaded from CoralNet 
metadata <- read.csv("metadata.csv") #Date,country,locality,site,strata info

#as we use some CoralNet default column names (Water.quality) for add information about the type of analysis (Fully automated, manual, visual), we are going to change name to column
colnames(metadata)[which(names(metadata) == "Water.quality")] <- "typesOFanalysis"
colnames(metadata)[which(names(metadata) == "Strobes")] <- "year"

#percentage cover by spp as CoralNet 
coverdata <- read.csv("percent_covers.csv") 

#merge metadata and cover data 
coverdata_metadata <- merge(metadata, coverdata, by = "Name", all.x = TRUE) 
labelset <- read.csv("labelset_matched.csv") #On above files only short name of species are give by default, so I created a .cvs with information about species and matched with WORMS


#transform dataframe in long format sutable for analisis 
cover = melt(coverdata_metadata, id.vars = 1:20, measure.vars = 21:ncol(coverdata_metadata), variable_name = "Shortname", value_name ="cover", na.rm = T)

## Join the taxon fields with the cover data using shortnames from CORALNET 
cover = left_join(cover, labelset, by = c("Shortname"="Short.Code"))

#Calculate mean, SD, SE for cover data by factors (species=Shortname,site, strata,) 
Coverdata.strata <- summaryBy(value ~ Shortname + site + strata + typesOFanalysis + year ,data =cover, FUN = function(x) { c(mean = mean(x),SD=sd(x),SE = sqrt(var(x)/length(x)))})

#Subset only abundant species
Coverdata.abundant <- subset(Coverdata.strata,Shortname=="aBareRock" |Shortname=="MEJI"|Shortname=="ENTEROMORP"|Shortname=="COC"|Shortname=="FILA"|Shortname=="ULVA"|Shortname=="CIRRIPEDIO")

#exclude 2019 data 
Coverdata.abundant <- subset(Coverdata.abundant,year!="2019")

#Change levels names
levels(Coverdata.abundant$typesOFanalysis)
levels(Coverdata.abundant$typesOFanalysis) <-  c("Alleviate 60%", "Alleviate 80%","Fully Automated Annotations", "9000 manual annotations","Visual")


#Data of %cover estimated visual and by robot for correlations analysis
correlations <- read.csv("percent_covers_correlations.csv")
```

Photo vs Visual General 
===================================== 

Column1{data-width=150}
-------

Methods:

- Comparison among visual quadrats and photoquadrats. The photoquadrats were analized fully manual (9000 points). 

- Only most representative taxa are showed.

- Bars represent mean + SE


Column2 {.tabset .tabset-fade}
-------

### All sites {data-width=150}
```{r}
ggplot(subset(Coverdata.abundant,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW"))+ labs(fill = "SPP",x = "", y = "Cover (%)", title = "") + facet_grid(site~typesOFanalysis)+scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + facet_grid(site~typesOFanalysis)

```

###Punta Cuevas 
```{r}
puntacuevas <- subset(Coverdata.abundant,site=="PUNTA CUEVAS")
ggplot(subset(puntacuevas,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + facet_grid(~typesOFanalysis)
```   

###Punta Este 
```{r}
puntacuevas <- subset(Coverdata.abundant,site=="PUNTA ESTE")
ggplot(subset(puntacuevas,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + facet_grid(~typesOFanalysis)
```   

###Punta Loma
```{r}
puntacuevas <- subset(Coverdata.abundant,site=="PUNTA LOMA")
ggplot(subset(puntacuevas,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + facet_grid(~typesOFanalysis)
```   

Photo vs Visual by taxa {data-orientation=rows} 
=====================================  

Row {data-height=35}
-------------------------------------
    
### Methods

Comparison among visual quadrats and photoquadrats. The photoquadras were analized fully manual (9000 points). On the tabs the results for the most conspicuous taxa are showed.

   
Row {.tabset .tabset-fade} 
-------------------------------------
   
### Bare Substrate 
```{r}
Coverdata1 <- subset(Coverdata.abundant,Shortname=="aBareRock")
ggplot(subset(Coverdata1,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")
```   
 
### Mejillones
```{r}
Coverdata2 <- subset(Coverdata.abundant,Shortname=="MEJI")
ggplot(subset(Coverdata2,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")
```

### Ulva
```{r}
Coverdata3 <- subset(Coverdata.abundant,Shortname=="ULVA")
ggplot(subset(Coverdata3,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")
```

### Enteromorpha
```{r}
Coverdata4 <- subset(Coverdata.abundant,Shortname=="ENTEROMORP")
ggplot(subset(Coverdata4,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")
```

### Corallinas 
```{r}
Coverdata5 <- subset(Coverdata.abundant,Shortname=="COC")
ggplot(alpha=0.7,subset(Coverdata5,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")
```


CoralNet Robot performance 
===================================== 

Column1{data-width=150}
-------

Methods:

- The same set of Photos (n=90) was analyzed by different levels of alleviate and fully automated to see how the robot is working. Alleviate 80% means that the robot of CoralNet will annotate all those points in which it has a confidence superior to 80%. 

- 90 photos analyzed by Human = 9000 points Human Analyst

- 90 photos Alleviate 80% = 5863 points CoralNet robot and 3137 points Human Analyst

- 90 photos Alleviate 60%= 7719 points CoralNet robot and 1281 points Human Analyst

- 90 photos Fully Automated = 9000 points CoralNet robot


Column2 {.tabset .tabset-fade}
-------

### Auto vs Manual vs Visual {data-width=150}
```{r}
ggplot(subset(Coverdata.abundant,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Fully Automated Annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom") + facet_grid(site~typesOFanalysis)

```

###Auto vs Visual 
```{r}

ggplot(subset(Coverdata.abundant,typesOFanalysis=="Fully Automated Annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom") + facet_grid(site~typesOFanalysis)
```   

###Auto vs Manual 
```{r}
ggplot(subset(Coverdata.abundant,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom") + facet_grid(site~typesOFanalysis)
```   

###Different levels robots 
```{r}
ggplot(subset(Coverdata.abundant,typesOFanalysis=="Alleviate 60%"|typesOFanalysis=="Alleviate 80%"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom") + facet_grid(site~typesOFanalysis)
```   

### Auto vs Manual vs Visual (Punta Loma)
```{r}
puntaloma <- subset(Coverdata.abundant,site=="PUNTA LOMA")
ggplot(subset(puntaloma,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Fully Automated Annotations"|typesOFanalysis=="Visual"),aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom") + facet_grid(site~typesOFanalysis)

```


CoralNet Robot performance by taxa {data-orientation=rows} 
=====================================  

Row {data-height=40}
-------------------------------------
    
### Methods

Comparison among photoquadrats analyzed by Human (900 manual anntations) vs Robot (Fully automated annotations) vs Visual (inspection in situ) by taxa. On the tabs the results of regressions are showed.

   
Row {.tabset .tabset-fade} 
-------------------------------------
   
### Bare Substrate 
```{r,cache=TRUE}
Coverdata1 <- subset(Coverdata.abundant,Shortname=="aBareRock")
ggplot(subset(Coverdata1,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")

ggscatter(correlations, x = "aBareRock", y = "aBareRock.A", add = "reg.line") +
  labs(title="Bare Substrate", y="CoralNet",x="Visual")+ ylim(0,100)+ xlim(0,100)+
  stat_cor(label.x = 3, label.y = 100) 
```   
 
### Mejillones
```{r,cache=TRUE}
Coverdata2 <- subset(Coverdata.abundant,Shortname=="MEJI")
ggplot(subset(Coverdata2,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")

ggscatter(correlations, x = "MEJI", y = "MEJI.A", add = "reg.line") +
  labs(title="Mejillones", y="CoralNet",x="Visual")+ ylim(0,100)+
  stat_cor(label.x = 3, label.y = 100) 
```

### Ulva
```{r,cache=TRUE}
Coverdata3 <- subset(Coverdata.abundant,Shortname=="ULVA")
ggplot(subset(Coverdata3,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")


ggscatter(correlations, x = "ULVA", y = "ULVA.A", add = "reg.line") +
  labs(title="ULVA", y="CoralNet",x="Visual")+ ylim(0,100)+ xlim(0,100)+
  stat_cor(label.x = 3, label.y = 100) 
```

### Enteromorpha
```{r,cache=TRUE}
Coverdata4 <- subset(Coverdata.abundant,Shortname=="ENTEROMORP")
ggplot(subset(Coverdata4,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")

ggscatter(correlations, x = "ENTEROMORP", y = "ENTEROMORP.A", add = "reg.line") +
  labs(title="ENTEROMORP", y="CoralNet",x="Visual")+ ylim(0,100)+ xlim(0,100)+
  stat_cor(label.x = 3, label.y = 100)
```

### Corallinas 
```{r,cache=TRUE}
Coverdata5 <- subset(Coverdata.abundant,Shortname=="COC")
ggplot(subset(Coverdata5,typesOFanalysis=="9000 manual annotations"|typesOFanalysis=="Visual"|typesOFanalysis=="Fully Automated Annotations"),aes(x=strata,y=value.mean,fill=typesOFanalysis)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) + facet_grid(Shortname~site) + labs(fill = "Method",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom")

ggscatter(correlations, x = "COC", y = "COC.A", add = "reg.line") +
  labs(title="Algas Coralinas", y="CoralNet",x="Visual")+ ylim(0,100)+ xlim(0,100)+
  stat_cor(label.x = 3, label.y = 100)
```

Punta Cuevas 2018 vs 2019 {data-orientation=Columns} 
=====================================  


Column1{data-width=150}
-------

Methods:

- There was a disappearance of Mussels in 2019 

- Punta Cuevas Photos from 2019 were analyzed with 60% alleviate 

- Bars represent mean + SE


Column2 {.tabset .tabset-fade}
-------

### Punta Cuevas {data-width=150}
```{r}
Coverdata.abundant2 <- subset(Coverdata.strata,Shortname=="aBareRock" |Shortname=="MEJI"|Shortname=="ENTEROMORP"|Shortname=="COC"|Shortname=="FILA"|Shortname=="ULVA"|Shortname=="CIRRIPEDIO")
puntacuevas <- subset(Coverdata.abundant2, site=="PUNTA CUEVAS" & typesOFanalysis=="Alleviate 60%")
ggplot(puntacuevas,aes(x=strata,y=value.mean,fill=Shortname)) + geom_bar(alpha=0.7,stat="identity",color="black",position=position_dodge()) + scale_color_grey() + geom_errorbar(aes(ymin=value.mean-value.SE, ymax=value.mean+value.SE), width=.2,position=position_dodge(.9)) + theme_bw() + scale_y_continuous(limits = c(0,100))+ scale_x_discrete(limits=c("HIGHTIDE","MIDTIDE","LOWTIDE"),labels=c("HIGHT","MID","LOW")) +scale_fill_brewer(palette="Paired",name = "Taxa",labels = c("Sustrato desnudo","Cirripedios","Algas coralinas","Enteromopha","Algas filamentosas","Mejillones","Ulva")) + labs(fill = "SPP",x = "", y = "Cover (%)", title = "",caption ="Mean + SE") + theme(legend.position = "bottom") + facet_grid(~year)

```
